const{promisify:promisify}=require("util"),download=promisify(require("download-git-repo")),inquirer=require("inquirer"),fs=require("fs"),handlebars=require("handlebars"),{resolve:resolve}=require("path"),path=require("path"),{run:run}=require("runjs"),{fscreateReadStream:fscreateReadStream,fscreateWriteStream:fscreateWriteStream}=require("./common.js");module.exports.clone=async(e,n)=>{console.log("__dirname : "+__dirname),console.log("resolve   : "+resolve("./"));const r=require("ora"),o=r(`下载...${e}`);o.start(),await download(e,n,{clone:!0},e=>{console.log(e?"err":"success"),console.log(e),o.succeed(),inquirer.prompt([{type:"input",name:"name",message:"请输入项目名称"},{type:"input",name:"description",message:"请输入项目简介"},{type:"input",name:"author",message:"请输入作者名称"}]).then(e=>{console.log(e);var r=`${n}/package.json`,o=fs.readFileSync(r,"utf8"),e=handlebars.compile(o)(e);fs.writeFileSync(r,e),inquirer.prompt([{type:"checkbox",name:"choice",message:"请选择配置的功能",default:[0,1,2],choices:[{value:1,name:"layout"},{value:2,name:"new!"}]}]).then(e=>{console.log("answers",e),run("npm install",{cwd:`${resolve("./")}/${n}`}),run("npm run lint:fix",{cwd:`${resolve("./")}/${n}`}),run("npm run dev:mock",{cwd:`${resolve("./")}/${n}`})}).catch(e=>{console.log(e)})})})};