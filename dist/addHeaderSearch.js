const resolve=require("path")["resolve"],{fscreateReadStream,fscreateWriteStream,isFileExisted,newStr}=require("./common.js"),run=require("runjs")["run"],chalk=require("chalk"),log=e=>console.log(chalk.green(e)),errorLog=e=>console.log(chalk.red(e));module.exports=async r=>{"string"!=typeof r&&(r=""),log("resolve   : "+resolve("./")+"/"+r);let e=resolve("./")+(r&&0!==r.length?"/"+r:"");try{o=e+"/src/components/HeaderSearch/index.vue",i=__dirname+"/../PCFile/headerSearch.txt";var t=await(await isFileExisted(o)?(errorLog("已存在目标文件src/components/HeaderSearch/index.vue"),Promise.reject(new Error("Error"))):(o=await fscreateReadStream(i),Promise.resolve(o))),a=await async function(){var r=e+"/src/layout/components/Navbar.vue";if(await isFileExisted(r)){let e=await fscreateReadStream(r);return-1<e.indexOf("<screenfull")&&-1===e.indexOf("<search ")?(e=newStr(e,e.indexOf("<screenfull"),`<HeaderSearch id="header-search" class="right-menu-item" :style="{'color':navbarColor }" />
                        `),e=newStr(e,e.indexOf("export default "),`import HeaderSearch from '@/components/HeaderSearch'
                        `),e=newStr(e,e.indexOf("Hamburger,"),`HeaderSearch,
                        `),Promise.resolve(e)):(errorLog(`src/layout/components/Navbar.vue文件修改失败!
                请检查代码:
                1、是否有: <screenfull
                2、是否已添加：<HeaderSearch id="header-search" class="right-menu-item" :style="{'color':navbarColor }" />
                `),Promise.reject(new Error("Error")))}return errorLog("找不到src/layout/components/Navbar.vue目标文件，请查看命令是否使用正确"),Promise.reject(new Error("Error"))}(),s=await async function(){var r=e+"/src/store/getters.js";if(await isFileExisted(r)){let e=await fscreateReadStream(r);return-1<e.indexOf("sidebar: state => state.app.sidebar,")&&-1===e.indexOf("permission_routes:")?(e=newStr(e,e.indexOf("sidebar: state => state.app.sidebar,"),`permission_routes: state => state.permission.routes,
                `),Promise.resolve(e)):(errorLog(`src/store/getters.js文件修改失败!
                请检查代码:
                1、是否有: 'sidebar: state => state.app.sidebar,'
                2、是否已添加：'permission_routes: state => state.permission.routes,'
                `),Promise.reject(new Error("Error")))}return errorLog("找不到src/store/getters.js目标文件，请查看命令是否使用正确"),Promise.reject(new Error("Error"))}();await fscreateWriteStream(e+"/src/components/HeaderSearch","index.vue",t),log("src/components/HeaderSearch/index.vue文件添加成功"),await fscreateWriteStream(e+"/src/layout/components","Navbar.vue",a),log("src/layout/components/Navbar.vue文件修改成功"),await fscreateWriteStream(e+"/src/store","getters.js",s),log("src/store/getters.js文件修改成功"),run("npm run lint:fix",{cwd:e})}catch(e){if(errorLog("addHeaderSearch 目标代码出错，请按上述报错信息检查代码"),r&&0!==r.length)return Promise.reject(()=>{})}var o,i};