const{resolve:resolve}=require("path"),{fscreateReadStream:fscreateReadStream,fscreateWriteStream:fscreateWriteStream,isFileExisted:isFileExisted,newStr:newStr}=require("./common.js"),{run:run}=require("runjs"),chalk=require("chalk"),log=e=>console.log(chalk.green(e)),errorLog=e=>console.log(chalk.red(e));module.exports=async r=>{"string"!=typeof r&&(r=""),log("resolve   : "+resolve("./")+"/"+r);let e=resolve("./")+(r&&0!==r.length?`/${r}`:"");try{var a=await async function(){var r=`${e}/src/layout/index.vue`;if(await isFileExisted(r)){let e=await fscreateReadStream(r);if(-1<e.indexOf("</el-header>"))return errorLog("上下布局,不能配置导航标签"),Promise.reject(new Error("Error"));if(-1<e.indexOf("<tags-view />"))return errorLog("已添加配置导航标签"),Promise.reject(new Error("Error"));var a="<navbar />";if(-1<e.indexOf(a)){e=e.replace(a,`<navbar />
        <tags-view />`),e=newStr(e,e.indexOf("export default {"),`import TagsView from './components/TagsView'
                   `);r=e.match(/(Navbar,([\s\S]*?)Sidebar)/g),r=r&&r[0];return e=e.replace(r,`Navbar,
                    Sidebar,
                    TagsView`),e=e.replace(`.fixed-header+.app-main {
  padding-top: 50px;
}`,`.fixed-header+.app-main {
  padding-top: 90px;
}`),Promise.resolve(e)}return errorLog(`src/layout/index.vue文件修改失败!
                请检查代码:
                1、是否有:${a}
                `),Promise.reject(new Error("Error"))}return errorLog("找不到src/layout/index.vue目标文件，请查看命令是否使用正确"),Promise.reject(new Error("Error"))}(),t=(n=`${e}/src/store/modules/tagsView.js`,c=`${__dirname}/../PCFile/TagsView/tagsView.js`,await(await isFileExisted(n)?(errorLog("已存在目标文件src/store/modules/tagsView.js"),Promise.reject(new Error("Error"))):(c=await fscreateReadStream(c),Promise.resolve(c))));i=`${e}/src/layout/components/TagsView/index.vue`,s=`${__dirname}/../PCFile/TagsView/index.vue`,o=`${__dirname}/../PCFile/TagsView/ScrollPane.vue`,await(await isFileExisted(i)?(errorLog("已存在目标文件src/layout/components/TagsView"),Promise.reject(new Error("Error"))):(s=await fscreateReadStream(s),o=await fscreateReadStream(o),await fscreateWriteStream(`${e}/src/layout/components/TagsView`,"index.vue",s),await fscreateWriteStream(`${e}/src/layout/components/TagsView`,"ScrollPane.vue",o),Promise.resolve(!0))),await fscreateWriteStream(`${e}/src/layout`,"index.vue",a),log("src/layout/index.vue文件修改成功"),await fscreateWriteStream(`${e}/src/store/modules`,"tagsView.js",t),log("src/store/modules/tagsView.js文件添加成功"),run("npm run lint:fix",{cwd:`${e}`})}catch(e){if(errorLog("addTagsView 目标代码出错，请按上述报错信息检查代码"),r&&0!==r.length)return Promise.reject(()=>{})}var i,s,o,n,c};