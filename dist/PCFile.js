const{promisify:promisify}=require("util"),download=promisify(require("download-git-repo")),inquirer=require("inquirer"),fs=require("fs"),handlebars=require("handlebars"),{resolve:resolve}=require("path"),{run:run}=require("runjs"),chalk=require("chalk"),log=e=>console.log(chalk.green(e)),errorLog=e=>console.log(chalk.red(e)),addBreadcrumb=require("./addBreadcrumb.js"),addTagsView=require("./addTagsView.js"),addGameShow=require("./addGameShow.js"),addUnifiedLogin=require("./addUnifiedLogin.js"),addSwitchEnvironment=require("./addSwitchEnvironment.js"),addHeaderSearch=require("./addHeaderSearch.js"),addNew=require("./addNew.js"),addNavBarMenu=require("./addNavBarMenu.js");module.exports.clonePC=async(e,i)=>{log("__dirname : "+__dirname),log("resolve   : "+resolve("./"));const a=require("ora"),r=a(`下载...${e}`);r.start(),await download(e,i,{clone:!0},e=>e?(errorLog(`
            error: ${e}`),void r.fail("下载失败")):(log(`
            success`),r.succeed("下载成功"),void inquirer.prompt([{type:"input",name:"name",message:"请输入项目名称"},{type:"input",name:"description",message:"请输入项目简介"},{type:"input",name:"author",message:"请输入作者名称"}]).then(async e=>{console.log(e);var a=`${i}/package.json`,r=fs.readFileSync(a,"utf8"),e=handlebars.compile(r)(e);fs.writeFileSync(a,e),inquirer.prompt([{type:"checkbox",name:"funcName",message:"请选择配置功能",checked:!0,choices:[{value:"Breadcrumb",name:"Breadcrumb (添加面包屑)"},{value:"SwitchEnvironment",name:"SwitchEnvironment (添加切换环境按钮)"},{value:"HeaderSearch",name:"HeaderSearch (添加菜单搜索)"},{value:"New",name:"New（添加菜单new！标志)"},{value:"UnifiedLogin",name:"UnifiedLogin (接入统一登入)"},{value:"GameShow",name:"GameShow (添加展示游戏平台)"}],default:["New","SwitchEnvironment"]}]).then(async e=>{log("rows",e),run("npm install",{cwd:`${resolve("./")}/${i}`});var a=e.funcName||[];for(let e=0;e<a.length;e++)switch(a[e]){case"TagsView":await addTagsView(i);break;case"Breadcrumb":await addBreadcrumb(i);break;case"GameShow":await addGameShow(i);break;case"UnifiedLogin":await addUnifiedLogin(i);break;case"SwitchEnvironment":await addSwitchEnvironment(i);break;case"HeaderSearch":await addHeaderSearch(i);break;case"New":await addNew(i);break;case"NavBarMenu":await addNavBarMenu(i);break;default:errorLog("请输入选择的功能名")}run("npm run lint:fix",{cwd:`${resolve("./")}/${i}`}),run("npm run dev:mock",{cwd:`${resolve("./")}/${i}`})}).catch(e=>{errorLog(e)})})))};