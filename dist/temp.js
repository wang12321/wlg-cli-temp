const resolve=require("path")["resolve"],{fscreateReadStream,fscreateWriteStream,isFileExisted,format,newStr}=require("./common.js"),inquirer=require("inquirer"),chalk=require("chalk"),log=e=>console.log(chalk.green(e)),errorLog=e=>console.log(chalk.red(e));module.exports=async s=>{log("resolve   : "+resolve("./")),log("name : "+s),inquirer.prompt([{type:"input",name:"path",message:`请确认添加文件路径${resolve("./")}/`+s,default:!0}]).then(e=>{!0===e.path?async function(){"/"===s.substring(0,1)&&(s=s.substring(1,s.length));var e=resolve("./")+"/"+s;await isFileExisted(e)?errorLog(resolve("./")+`/${s}目标文件已存在`):inquirer.prompt([{type:"rawlist",name:"choice",message:"请选择架构",default:0,choices:[{value:1,name:"基础模板"},{value:2,name:"增删改查模板"}]}]).then(async e=>{let r="template.txt",t="基础模板";2===e.choice&&(r="addFile.txt",t="增删改查模板");var a,i,e=await fscreateReadStream(__dirname+"/../PCFile/"+r);-1<s.indexOf(".vue")&&-1<s.indexOf("/")?(a=(i=s.split("/"))[i.length-1],i=i.slice(0,i.length-1).join("/"),await fscreateWriteStream(resolve("./")+"/"+i,""+a,e)):-1<s.indexOf(".vue")&&-1===s.indexOf("/")?await fscreateWriteStream(""+resolve("./"),""+s,e):await fscreateWriteStream(resolve("./")+"/"+s,"index.vue",e),log(t+"新增文件成功")})}():errorLog("已取消新增，请重新cd文件路径添加")})};